
@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Index</title>

    <link href="~/Content/bootstrap.min.css" rel="stylesheet" />
    <link href="~/Scripts/select2/css/select2.min.css" rel="stylesheet" />
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="//cdn.bootcss.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="//cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <style>
        body {
            /*padding-top: 40px;*/
            /*padding-bottom: 40px;*/
            background-color: #eee;
        }
        select { min-width: 300px; }
        [v-cloak] { display: none; }

    </style>

</head>
<body>
    <div class="container" id="app">
        <div class="jumbotron" style="margin-bottom: -25px;">
            <h1>2016年易展展新日  <small>绽放易.Young青春</small></h1>
            <h2 class="text-center">青春大舞台</h2>
            <p style="    font-size: 16px;    color: gray;">
                【年会选座】请先选择您的姓名，再选择年会座位
                <br />
                【截至日期】2016-1-19 下班前
                <br />
                【注意】<br />
                1.无法正常打开页面请用极速模式或使用谷歌浏览器<br />
                2.目前仅限公司内网使用
            </p>
        </div>
        <div class="row">
            <div class="col-lg-12">
                <div class="input-group">
                    <select v-select="v.me_userId" style="width:95%;">
                        <option value="0">请先选择这里！ 输入姓名,确认身份（每桌限10人）</option>
                        <option v-for="option in e.usersAll | filterBy 0 in 'parentId'" v-bind:value="option.userId">
                            {{  option.userName }} - {{ option.deptName}}
                        </option>
                    </select>
                    <div class="input-group-btn">
                        <button type="button" class="btn btn-primary  btn-sm" data-toggle="modal" data-toggle="modal" data-target="#homeModal">修改员工住址信息</button>
                        <button id="flashuserbtn" type="button" class="btn btn-primary  btn-sm" v-on:click="flushuserall" style="margin-left: 20px;" data-loading-text="Loading..." autocomplete="off">刷新座位</button>
                    </div>
                </div>
            </div>
        </div>
        <br />
        <br />
        <template v-for="i in 3">
            <div class="row">
                <template v-for="n in 3">
                    <div class="col-md-4" v-show="((n+1)+i*3)!=9">
                        <ul class="list-group">
                            <li class="list-group-item active">
                                {{(n+1)+i*3 }}号桌
                                <a class="badge badge_ashow{{(n+1)+i*3 }}" data-toggle="modal" data-target="#myModal" v-show="canAddFamily" v-on:click="sitherefn(((n+1)+i*3))" v-cloak>+带家属坐这</a>
                                <a class="badge badge_ashow{{(n+1)+i*3 }}" v-show="isSitHere" v-on:click="sitadd(0,((n+1)+i*3))" v-cloak>我要坐这</a>
                            </li>
                            <li class="list-group-item">
                                <p class="list-group-item-text">
                                    <template v-for="option in e.usersAll | filterBy ((n+1)+i*3) in 'groupId'">
                                        <a class="badge" style="margin-right: 5px;" href="javascript:;" v-if="(v.me_userId>0 && option.parentId == v.me_userId)" v-on:click="sitdel(((n+1)+i*3),option.userId,option.parentId)">
                                            {{option.userName}}
                                        </a>
                                        <span class="badge" v-else style="margin-right: 5px;">{{option.userName}}</span>

                                    </template>
                                </p>
                                <br />
                                <p class="list-group-item-text text-muted">点击自己家属可移除</p>
                            </li>
                        </ul>
                    </div>
                </template>
            </div>
        </template>
        <!-- Modal -->
        <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"></button>
                        <h4 class="modal-title" id="myModalLabel">带家属参加展新日-{{v.me_userInfo.userName}}</h4>
                    </div>
                    <div class="modal-body">
                        <div class="row">
                            <div class="form-horizontal">
                                <div class="form-group">
                                    <label class="col-sm-2 control-label">家属</label>
                                    <div class="col-sm-9 input-group">
                                        <select class="form-control" v-model="v.f_type" v-on:change="familyNamefn">
                                            <option v-for="option in e.typeItems" v-bind:value="option.text">
                                                {{ option.text }}
                                            </option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-2 control-label">性别</label>
                                    <div class="col-sm-9 input-group">
                                        <select class="form-control" v-model="v.f_sex" v-on:change="familyNamefn">
                                            <option v-for="option in e.sexItems" v-bind:value="option.text">
                                                {{ option.text }}
                                            </option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-2 control-label">名称</label>
                                    <div class="col-sm-9 input-group">
                                        <input type="type" class="form-control" name="name" v-model="v.f_name" readonly/>
                                    </div>
                                </div>
                                <div class="alert alert-danger" v-show="v.f_btnalert!=''">{{v.f_btnalert}}</div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                        <button type="button" class="btn btn-primary" v-on:click="sitadd(v.me_userId)" data-loading-text="请等待..." autocomplete="off" id="myhomebtn">保存</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- Modal -->
        <div class="modal fade" id="homeModal" tabindex="0" role="dialog" aria-labelledby="myModalLabel">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"></button>
                        <h4 class="modal-title" id="myModalLabel">员工住址收集-福委会 <small style="color:red;">没有填写住址信息将不能参与年会选座</small></h4>
                    </div>
                    <div class="modal-body">
                        <div class="row">
                            <div class="form-horizontal">
                                <div class="form-group">
                                    <label class="col-sm-3 control-label">员工姓名</label>
                                    <div class="col-sm-8 input-group" style="padding:0 15px;">
                                        <div class="input-group-btn">
                                            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> {{v.f_depname}}&nbsp;&nbsp;&nbsp;&nbsp;<span class="caret"></span></button>
                                            <ul class="dropdown-menu">
                                                <li v-for="option in e.depItems" v-on:click="selectdepfn(option)">
                                                    <a href="#">{{ option.deptName }}</a>
                                                </li>
                                            </ul>
                                        </div>
                                        <input type="text" class="form-control" placeholder="请填写完整姓名，编辑或添加" v-on:blur="onBlur" v-model="v.f_hname">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-3 control-label">紧急联系人手机</label>
                                    <div class="col-sm-8 input-group" style="padding:0 15px;">
                                        <div class="input-group-btn">
                                            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> {{v.f_relative}}&nbsp;&nbsp;&nbsp;&nbsp;<span class="caret"></span></button>
                                            <ul class="dropdown-menu">
                                                <li v-for="option in e.relativeitems" v-on:click="selectrelpfn(option)">
                                                    <a href="#">{{ option.text }}</a>
                                                </li>
                                            </ul>
                                        </div>
                                        <input type="text" class="form-control" placeholder="紧急联系手机&固话" v-model="v.f_hphone">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-3 control-label">居住住址</label>
                                    <div class="col-sm-8">
                                        <textarea class="form-control" rows="3" placeholder="当前居住详细地址" v-model="v.f_remark"></textarea>
                                    </div>
                                </div>
                                <div class="alert alert-danger" v-show="v.btnalert!=''">{{v.btnalert}}</div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                        <button type="button" class="btn btn-primary" v-on:click="saveuser()" autocomplete="off" id="homebtn" data-loading-text="请等待...">{{v.btnhome}}</button>
                    </div>
                </div>
            </div>
        </div>
    </div> 
    <script src="~/Scripts/jquery-2.1.3.min.js"></script>
    <script src="~/Scripts/bootstrap.min.js"></script>
    <script src="~/Scripts/select2/js/select2.min.js"></script>
    <script src="~/Scripts/Vue/vue.js"></script>
    <script src="~/Scripts/Vue/vue-resource.js"></script>
    <script src="~/Scripts/underscore-min.js"></script>
    <script src="~/Scripts/app/active.js"></script>
</body>
</html>
